<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì°¸ê°€ ì œì¶œì§€ â€“ ì œ 3íšŒ ëˆ„ì— ê³ ì¹˜ ì„±ë³„ ë§ì¶”ê¸° ëŒ€íšŒ</title>
  <style>
    :root{
      --bg:#ffffff; --paper:#ffffff; --ink:#111827; --sub:#6b7280;
      --pri:#4b5563; --muted:#e5e7eb; --ring:rgba(107,114,128,.25);
      --shadow:0 10px 30px rgba(17,24,39,.08);
      --green:#059669; --blue:#1e3a8a; --blue-bd:#bfdbfe; --blue-bg:#eff6ff;
      --rose:#9d174d; --rose-bd:#fbcfe8; --rose-bg:#fdf2f8;
      --danger:#ef4444; --danger-bd:#fecaca; --danger-bg:#fef2f2;

      /* íƒ€ì… ì»¬ëŸ¬ */
      --gold:#f59e0b; --gold-bg:#fff7ed;
      --mimic:#7c3aed; --mimic-bg:#f5f3ff;
      --trap:#b91c1c; --trap-bg:#fef2f2;
      --normal:#374151; --normal-bg:#f3f4f6;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Pretendard,Apple SD Gothic Neo,Malgun Gothic,Arial,sans-serif}
    .wrap{max-width:980px;margin:0 auto;padding:24px}
    header.nav{position:sticky;top:0;backdrop-filter:saturate(180%) blur(8px);background:rgba(247,246,243,.75);border-bottom:1px solid var(--muted);z-index:50}
    .nav-inner{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:14px 24px}
    .brand{display:flex;align-items:center;gap:10px;text-decoration:none;color:var(--ink)}
    .brand strong{font-weight:800}
    .btn{
      display:inline-flex;align-items:center;justify-content:center;gap:8px;
      padding:10px 14px;border-radius:999px;border:1px solid var(--muted);
      background:var(--paper);color:var(--ink);text-decoration:none;font-weight:600;
      text-align:center;
    }
    .btn.primary{background:var(--pri);color:#fff;border:0}
    .btn.success{background:var(--green);color:#fff;border:0}
    .btn:hover{box-shadow:0 6px 18px rgba(15,23,42,.08)}
    .btn.lg{font-size:16px; padding:10px 18px; min-height:42px; min-width:140px}
    @media (min-width:768px){ .btn.lg{font-size:17px; padding:12px 22px; min-width:180px} }

    .hero{margin:20px auto 14px;border-radius:24px;background:
      radial-gradient(1200px 600px at 10% -10%, #f3f4f6, transparent 60%),
      radial-gradient(1200px 600px at 110% 10%, #eef2f7, transparent 60%),
      var(--paper);box-shadow:var(--shadow)}
    .hero-grid{display:grid;grid-template-columns:1fr;gap:12px;padding:24px}
    .hero h1{margin:0;font-size:clamp(22px,4vw,32px);letter-spacing:-.3px;line-height:1.15;text-align:center}
    .hero .sub{margin:6px 0 0;color:var(--sub);font-weight:600;text-align:center}

    .card{background:var(--paper);border:1px solid var(--muted);border-radius:16px;box-shadow:var(--shadow);overflow:hidden}
    .card .inner{padding:18px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    @media (max-width:720px){.grid{grid-template-columns:1fr}}

    label{font-weight:700;display:block;margin-bottom:6px}
    .subnote{color:var(--sub);font-size:12px;margin-top:4px}
    input[type="text"], input[type="tel"]{
      width:100%; padding:10px 12px; border-radius:10px; border:1px solid var(--muted); outline:none; background:#fff;
    }
    input[type="text"]:focus, input[type="tel"]:focus{box-shadow:0 0 0 3px var(--ring)}
    input.invalid{border-color:var(--danger); box-shadow:0 0 0 2px rgba(239,68,68,.2)}
    .checkbox-invalid{outline:2px solid rgba(239,68,68,.6); outline-offset:3px; border-radius:6px; padding:2px}

    fieldset{border:1px solid var(--muted);border-radius:14px;padding:14px;transition:border-color .12s ease, box-shadow .12s ease, background .12s ease}
    fieldset.invalid{border-color:var(--danger-bd)}
    legend{font-weight:800;color:var(--blue);padding:0 6px}
    .qgrid{display:grid;grid-template-columns:140px 1fr 1fr;gap:14px;align-items:center}
    @media (max-width:900px){.qgrid{grid-template-columns:1fr}}
    .photo{width:140px;height:140px;border-radius:12px;background:#f3f4f6;border:1px solid var(--muted);display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}
    /* â¬‡ ë°•ìŠ¤ ê½‰ ì±„ìš°ê¸°(ì¤‘ì•™ ë°°ì¹˜, í•„ìš”ì‹œ í¬ë¡­) */
    .photo img{
      width:100%; height:100%;
      object-fit:cover; object-position:center;
      display:block; -webkit-user-drag:none; user-select:none;
    }
    .name{font-weight:800}

    /* íƒ€ì… ë°°ì§€ & ì¹© */
    .flag{
      position:absolute; left:8px; top:8px; padding:4px 8px; border-radius:999px;
      font-size:12px; font-weight:800; border:1px solid transparent; display:inline-flex; align-items:center; gap:6px;
      background:#fff;
    }
    .flag i{font-style:normal}
    .pill{
      display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; border:1px solid transparent;
      font-size:12px; font-weight:800; width:fit-content;
    }

    /* íƒ€ì…ë³„ ì»¬ëŸ¬ë§ */
    fieldset.type-normal{border-color:#e5e7eb; background:linear-gradient(180deg,var(--normal-bg),#fff 45%);}  
    fieldset.type-gold{border-color:var(--gold); background:linear-gradient(180deg,var(--gold-bg),#fff 45%); box-shadow:0 6px 20px rgba(245,158,11,.1)}
    fieldset.type-mimic{border-color:var(--mimic); background:linear-gradient(180deg,var(--mimic-bg),#fff 45%); box-shadow:0 6px 20px rgba(124,58,237,.08)}
    fieldset.type-trap{border-color:var(--trap); background:linear-gradient(180deg,var(--trap-bg),#fff 45%); box-shadow:0 6px 20px rgba(185,28,28,.08)}

    .flag.normal{color:var(--normal); border-color:#d1d5db; background:#fff}
    .flag.gold{color:var(--gold); border-color:#fcd34d; background:#fffdf4}
    .flag.mimic{color:var(--mimic); border-color:#ddd6fe; background:#faf7ff}
    .flag.trap{color:var(--trap); border-color:#fecaca; background:#fff5f5}

    .pill.normal{color:var(--normal); border-color:#d1d5db; background:#fff}
    .pill.gold{color:var(--gold); border-color:#fcd34d; background:#fffdf4}
    .pill.mimic{color:var(--mimic); border-color:#ddd6fe; background:#faf7ff}
    .pill.trap{color:var(--trap); border-color:#fecaca; background:#fff5f5}

    /* ìƒíƒœ ì•ˆë‚´ë¬¸êµ¬ */
    #status{min-height:24px; text-align:center; margin-top:6px}
    .notice{background:none !important; border:0 !important; border-radius:0 !important; padding:0 !important; display:inline !important; font-weight:700;}
    .notice-ok{color:#065f46}
    .notice-err{color:#b91c1c}

    .actions{display:flex;gap:12px;justify-content:center;padding:16px}
    .agree{display:flex;gap:8px;align-items:flex-start;margin-top:10px}
    .hp{position:absolute;left:-9999px;top:-9999px}

    .form-section-title{ text-align:center; }

    /* íƒ€ì… ì „ì„¤(ì„¤ëª…) */
    .legend-box{margin:16px 0 0; padding:12px; border:1px dashed #d1d5db; border-radius:12px; background:#fafafa}
    .legend-row{display:flex; gap:8px; flex-wrap:wrap}

    /* ê·œì¹™ ëª©ë¡ */
    .rules{ margin:10px 0 0; padding-left:18px; }
    .rules li{ margin:4px 0; }

    /* â¬‡ ê¶ê¸ˆí•´ìš”(ì•„ì½”ë””ì–¸) */
    .qa{ margin-top:12px }
    .qa details{ margin:8px 0; border:0 }
    .qa summary{
      list-style:none; cursor:pointer; display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:10px 12px; border:1px solid #d1d5db; border-radius:10px;
      background:#f3f4f6; color:#374151; font-weight:800;
      transition:background .15s ease, border-color .15s ease, box-shadow .15s ease, color .15s ease;
    }
    .qa summary::-webkit-details-marker{display:none}
    .qa summary::after{
      content:"â–¸"; font-size:14px; line-height:1; transform-origin:center; transition:transform .15s ease; color:#6b7280
    }
    .qa details[open] summary{
      background:#e5e7eb; border-color:#cbd5e1; border-bottom-left-radius:0; border-bottom-right-radius:0;
    }
    .qa details[open] summary::after{ transform:rotate(90deg) }
    .qa .ans{
      padding:12px; border:1px solid #cbd5e1; border-top:0; border-bottom-left-radius:10px; border-bottom-right-radius:10px;
      background:#fff; color:#111827;
    }

    /* ê³µì§€(ì˜¤í”ˆì±„íŒ…) ë¸”ë¡ */
    .announce{
      margin:12px 0 0; padding:12px; border:1px solid #e5e7eb; border-radius:12px;
      background:linear-gradient(180deg,#fffbe7,#fff);
    }
    .announce-row{ display:flex; flex-direction:column; align-items:center; gap:12px; text-align:center }
    .announce strong{ display:block; font-size:16px; margin-bottom:4px }
    .announce p{ margin:0; color:var(--sub) }
    .btn.kakao{ background:#FEE500; color:#111827; border:0; font-weight:800; white-space:nowrap }

    /* ëª¨ë°”ì¼(í°) ìµœì í™”: ì‚¬ì§„Â·ë²„íŠ¼ ë¹„ìœ¨ */
    @media (max-width:720px){
      .announce-row{ flex-direction:column; align-items:center }
      .btn.kakao{ width:auto }
      .photo{ width:100%; height:clamp(180px,58vw,260px); }
    }
      /* ëª¨ë°”ì¼ ë„¤ë¹„: ë²„íŠ¼ 1ì¤„ ìœ ì§€ */
    @media (max-width:480px){
      .nav-inner{ gap:8px; padding:10px 12px; }
      .nav-inner > .brand{ flex:1 1 auto; min-width:0; max-width:55%; }
      .brand{ font-size:14px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
      header.nav .nav-inner > div{ display:flex; gap:8px; flex-wrap:nowrap; }
      header.nav .btn{ font-size:14px; padding:8px 10px; white-space:nowrap; }
    }
      /* ì°¸ì—¬ í™•ì¸(í€µ ì²´í¬) */
    .quick{margin:10px 0 0; padding:12px; border:1px solid #e5e7eb; border-radius:12px; background:#f8fafc; text-align:center; display:flex; justify-content:center}
    .quick-row{display:inline-flex; gap:8px; align-items:center; justify-content:center; flex-wrap:nowrap}
    .quick input[type="tel"]{ width:clamp(220px, 50vw, 280px); max-width:100%; padding:10px 12px; border-radius:10px; border:1px solid var(--muted) }
    #quick-status{ min-height:22px; text-align:center; margin-top:6px }
    @media (max-width:480px){ .quick-row{ flex-wrap:wrap } .quick .btn{ width:auto } }
      /* ìƒí’ˆ ì•ˆë‚´ ë°•ìŠ¤ */
    .prize-box{ margin:10px 0 0; padding:12px; border:1px dashed #d1d5db; border-radius:12px; background:#fafafa }
    .prize-box strong{ display:block; text-align:center; margin-bottom:6px }
    .prize-list{ list-style:none; padding:0; margin:0; text-align:center; color:#111827 }
    .prize-list li{ margin:4px 0 }
  </style>
</head>
<body>
  <header class="nav">
    <div class="nav-inner wrap">
      <a class="brand" href="index.html"><strong>ğŸ›ëˆ„ì— ê³ ì¹˜ ì„±ë³„ ë§ì¶”ê¸° ëŒ€íšŒ</strong></a>
      <div>
        <a class="btn" href="index.html">Home</a>
        <a class="btn primary" href="3rd_leaderboard.html">ì œ 3íšŒ ë¦¬ë”ë³´ë“œ</a>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="hero">
      <div class="hero-grid">
        <h1>ì œ 3íšŒ ëŒ€íšŒ ì°¸ê°€ ì œì¶œì§€</h1>
        <div class="welcome" style="margin:8px 0 0; font-size:15px; color:#111827">
          <p style="margin:0"><strong>í•œë¦¬ì˜ ëˆ„ì— ê³ ì¹˜ ì„±ë³„ ë§ì¶”ê¸° ëŒ€íšŒ</strong>ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤! ğŸ‰ğŸ›</p>
          <p>ë°”ì˜ì‹  ì™€ì¤‘ì—ë„ ê¸°êº¼ì´ ì°¸ê°€í•´ ì£¼ì…”ì„œ ì§„ì‹¬ìœ¼ë¡œ ê°ì‚¬í•©ë‹ˆë‹¤. ì´ë²ˆ ëŒ€íšŒëŠ” <strong>ì˜¬í•´ ë§ˆì§€ë§‰ ëŒ€íšŒ</strong>ë¡œ, í•œ í•´ ë™ì•ˆ í•¨ê»˜í•´ ì£¼ì‹  <strong>ê´€ì‹¬ê³¼ ì‘ì›</strong>ì„ ë”°ëœ»í•˜ê²Œ ë§ˆë¬´ë¦¬í•˜ëŠ” ìë¦¬ì…ë‹ˆë‹¤. âœ¨ ì˜¤ëŠ˜ë§Œí¼ì€ <strong>ê·€ì—¬ìš´ ëˆ„ì—</strong>ë“¤ì„ ë”ìš± ì‚¬ë‘í•´ ì£¼ì‹œê³ , <strong>ì„¬ì„¸í•œ ê´€ì°°</strong>ë¡œ <strong>ê³ ì¹˜ ì† ë¹„ë°€</strong>ì„ ì¦ê²ê²Œ ì¶”ì¸¡í•´ ì£¼ì„¸ìš”. ğŸ” ì—¬ëŸ¬ë¶„ì˜ <strong>ë”°ëœ»í•œ ì‹œì„ ê³¼ ì‘ì›</strong>ì´ ì‘ì€ ìƒëª…ë“¤ì„ ë”ìš± ë¹›ë‚˜ê²Œ í•©ë‹ˆë‹¤. â¤ï¸ <strong>ì¦ê±°ìš´ ì°¸ì—¬</strong>ì™€ <strong>ì„ ì˜ì˜ ê²½ìŸ</strong>ì„ ê¸°ëŒ€í•©ë‹ˆë‹¤. ğŸ™ŒğŸ†</p>
          <div class="prize-box" aria-label="ìƒí’ˆ ì•ˆë‚´">
            <strong>ğŸ ìƒí’ˆ ì•ˆë‚´</strong>
            <ul class="prize-list">
              <li>ğŸ¥‡ 1ë“± : ì¹˜í‚¨ ê¸°í”„í‹°ì½˜ / ëˆ„ì— êµ¿ì¦ˆ (ì¶”í›„ ê³µê°œ)</li>
              <li>ğŸ¥ˆ 2ë“± : ë°°ë¯¼ ê¸°í”„í‹°ì½˜ / ëˆ„ì— êµ¿ì¦ˆ</li>
              <li>ğŸ¥‰ 3ë“± : ìŠ¤íƒ€ë²…ìŠ¤ ê¸°í”„í‹°ì½˜ / ëˆ„ì— êµ¿ì¦ˆ</li>
            </ul>
          </div>
          <p style="margin:8px 0 0; color:#6b7280; font-weight:600; text-align:center">ì£¼ìµœ: í•œë¦¬ / í›„ì› : í•œì§€í˜œ, ì¤‘ì•™ëŒ€í•™êµ í™”í•™/ìƒë¬¼ì •ë³´í•™ ì—°êµ¬ì‹¤ êµ¬ì„±ì›</p>
        </div>
      </div>
    </section>

    <!-- ì°¸ê°€ì ì •ë³´ -->
    <section class="card" aria-labelledby="hdr-info">
      <div class="inner">
        <h2 id="hdr-info" style="margin:0 0 12px">ì°¸ê°€ì ì •ë³´</h2>
        <div class="grid">
          <div>
            <label for="nickname">ì°¸ê°€ì ë‹‰ë„¤ì„ <span class="req" style="color:var(--danger)">*</span></label>
            <input id="nickname" name="nickname" type="text" placeholder="ì˜ˆ: ëˆ„ì—ì—¥"/>
          </div>
          <div>
            <label for="realname">ì°¸ê°€ì ì´ë¦„ <span class="req" style="color:var(--danger)">*</span></label>
            <input id="realname" name="realname" type="text" placeholder="ì˜ˆ: í•œë¦¬"/>
          </div>
          <div>
            <label for="phone">ì°¸ê°€ì íœ´ëŒ€í° ë²ˆí˜¸ <span class="req" style="color:var(--danger)">*</span></label>
            <input id="phone" name="phone" type="tel" inputmode="tel" maxlength="13" placeholder="ì˜ˆ: 010-1234-5678"/>
            <div class="subnote">ì…ë ¥ ì‹œ ìë™ìœ¼ë¡œ 000-0000-0000 í˜•ì‹ìœ¼ë¡œ ë³€í™˜ë©ë‹ˆë‹¤.</div>
          </div>
          <div>
            <label for="edition">íšŒì°¨</label>
            <input id="edition" name="edition" type="text" value="ì œ 3íšŒ" readonly/>
          </div>
        </div>
        <label class="agree" id="agreeWrap"><input type="checkbox" id="agree"/> ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš©ì— ë™ì˜í•©ë‹ˆë‹¤.</label>
        <div class="quick" role="region" aria-label="ì°¸ì—¬ í™•ì¸">
          <div class="quick-row">
            <input id="quick-phone" type="tel" inputmode="tel" maxlength="13" placeholder="íœ´ëŒ€í° ë²ˆí˜¸ (ì˜ˆ: 010-1234-5678)">
            <button type="button" class="btn primary" id="btn-quick-check">ì°¸ì—¬ í™•ì¸í•˜ê¸°</button>
          </div>
          <div id="quick-status"></div>
        </div>
      </div>
    </section>

    <!-- ì•ˆë‚´: íƒ€ì…/ì ìˆ˜ ê·œì¹™ + ê³µê°œ/ì±„ì  ê·œì¹™ + ê¶ê¸ˆí•´ìš” -->
    <section class="card" style="margin-top:12px">
      <div class="inner">
        <h2 style="margin:0 0 10px">ë¬¸í•­ íƒ€ì… & ì ìˆ˜ ê·œì¹™</h2>
        <div class="legend-box">
          <div class="legend-row">
            <span class="pill normal">ì¼ë°˜(13) Â· ì •ë‹µ +1 / ì˜¤ë‹µ 0</span>
            <span class="pill gold">í™©ê¸ˆ(2) Â· ì •ë‹µ +3 / ì˜¤ë‹µ 0</span>
            <span class="pill mimic">ë¯¸ë¯¹(ìœ„ì¥)(3) Â· ì •ë‹µ +2 / ì˜¤ë‹µ âˆ’2</span>
            <span class="pill trap">í•¨ì •(2) Â· ì •ë‹µ âˆ’3 / ì˜¤ë‹µ 0</span>
          </div>

          <h3 style="margin:12px 0 6px; font-size:16px">ê³µê°œÂ·ì±„ì  ìš´ì˜ ê·œì¹™</h3>
          <ol class="rules">
            <li><b>ê³ ì¹˜ë§ˆë‹¤ ì ìˆ˜ê°€ ë‹¤ë¦…ë‹ˆë‹¤.</b> (ê° ë¬¸í•­ì˜ <em>íƒ€ì… ë°°ì§€/ì ìˆ˜ ì¹©</em> í™•ì¸)</li>
            <li><b>ì¼ë°˜ê³ ì¹˜</b>ëŠ” <u>ëˆ„ì— ë‚˜ë°©ì´ ë˜ëŠ” ì¦‰ì‹œ</u> ì •ë‹µê³¼ í•¨ê»˜ ê³µê°œë©ë‹ˆë‹¤.</li>
            <li><b>íŠ¹ìˆ˜ê³ ì¹˜(í™©ê¸ˆ/ë¯¸ë¯¹Â·ìœ„ì¥/í•¨ì •)</b>ê°€ <b>ì¼ë°˜ê³ ì¹˜ë³´ë‹¤ ë¨¼ì €</b> ë‚˜ì™”ì„ ê²½ìš°
              <u>â€œëˆ„ì—ë‚˜ë°© ì¶œí˜„â€ë§Œ ê³µì§€</u>ë˜ê³  ì •ë‹µì€ ë¹„ê³µê°œë©ë‹ˆë‹¤. ì´í›„ <b>ì¼ë°˜ê³ ì¹˜ê°€ ë‚˜ì˜¨ ë’¤</b> í•´ë‹¹ íŠ¹ìˆ˜ê³ ì¹˜ ì •ë‹µì„ ê³µê°œí•˜ê³  ì ìˆ˜ë¥¼ ë°˜ì˜í•©ë‹ˆë‹¤.</li>
            <li><b>ëª¨ë“  ì¼ë°˜ê³ ì¹˜ ê³µê°œ ì´í›„</b>ì—ë„ <b>ë¯¸ë¯¹/í•¨ì •</b>ì´ ì•„ì§ ë‚˜ë°©ì´ ë˜ì§€ ì•Šì•˜ë‹¤ë©´,
              ê·¸ ê³ ì¹˜ë“¤ì€ <u>ë‚˜ì˜¤ìë§ˆì ìˆœì°¨ ê³µê°œ</u>ë˜ë©° ê³§ë°”ë¡œ ì ìˆ˜ë¥¼ ë°˜ì˜í•©ë‹ˆë‹¤.</li>
          </ol>

          <!-- ê³µì§€ ë°›ê¸°(ì˜¤í”ˆì±„íŒ…) -->
          <div class="announce" role="region" aria-labelledby="alert-title">
            <div class="announce-row">
              <div class="announce-text">
                <strong id="alert-title">ê³µì§€ ë°›ê¸°(ì˜¤í”ˆì±„íŒ…ë°©)</strong>
                <p>
                  í•´ë‹¹ ëŒ€íšŒì— ëŒ€í•œ ê³µì§€ë¥¼ ë°›ìœ¼ë ¤ë©´ ì˜¤í”ˆì±„íŒ…ë°©ì— ì°¸ì—¬í•˜ì‹­ì‹œì˜¤.</p>
                <p>
                  ì´ ë°©ì—ì„œëŠ” <b>ëŒ€íšŒ ì‹œì‘Â·ì¢…ë£Œ ì•Œë¦¼</b>, <b>ëˆ„ì—ê°€ ë‚˜ë°©ìœ¼ë¡œ ìš°í™”í•  ë•Œ ê³µì§€</b>, <b>ìˆ˜ìƒì ë°œí‘œ</b>ë¥¼ ì•ˆë‚´í•©ë‹ˆë‹¤.
                </p>
              </div>
              <a class="btn kakao lg" href="https://open.kakao.com/o/gm703oRh" target="_blank" rel="noopener noreferrer" aria-label="ì˜¤í”ˆì±„íŒ…ë°© ìƒˆ ì°½ì—ì„œ ì—´ê¸°">ğŸ”” ì±„íŒ…ë°© ì°¸ì—¬</a>
            </div>
          </div>

          <h3 style="margin:14px 0 6px; font-size:16px">ê¶ê¸ˆí•´ìš”</h3>
          <div class="qa">
            <details>
              <summary>ì™œ ëˆ„ì— ê³ ì¹˜ ìƒ‰ìƒì´ ë‹¤ë¥¸ê°€ìš”?</summary>
              <div class="ans">
                ëˆ„ì— ê³ ì¹˜ì˜ ìƒ‰ì€ ë½•ìì—ì„œ ë“¤ì–´ì˜¨ ìƒ‰ì†Œê°€ ì‹¤ì„ ë§Œë“œëŠ” ê¸°ê´€(ì‹¤ìƒ˜)ê¹Œì§€ ì–¼ë§ˆë‚˜ ì˜ ì˜®ê²¨ì ¸ì„œ ìŒ“ì´ëŠëƒì— ë”°ë¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤.
                íƒ€ê³ ë‚œ ìœ ì „ìì— ë”°ë¼ ì´ ìƒ‰ì†Œë¥¼ ì‹¤ì–´ ë‚˜ë¥´ê³  ë“¤ì—¬ë³´ë‚´ëŠ” ëŠ¥ë ¥ì´ ì„œë¡œ ë‹¤ë¥¸ë°, ì´ ëŠ¥ë ¥ì´ ì¢‹ìœ¼ë©´ ìƒ‰ì†Œê°€ ë§ì´ ìŒ“ì—¬ ê³ ì¹˜ê°€ ë…¸ë—ê±°ë‚˜ ê¸ˆë¹›ì„ ë ê³ ,
                ëŠ¥ë ¥ì´ ì•½í•˜ë©´ ìƒ‰ì†Œê°€ ê±°ì˜ ìŒ“ì´ì§€ ì•Šì•„ ê³ ì¹˜ê°€ í•˜ì–—ê²Œ ë³´ì…ë‹ˆë‹¤. ë½•ìì˜ ë‹¤ë¥¸ ì¢…ë¥˜ ìƒ‰ì†Œê°€ ë” ë§ì´ ìŒ“ì´ë©´ ì—°ë‘ìƒ‰ì´ë‚˜ ë…¹ìƒ‰ì´ ë‚˜íƒ€ë‚˜ê¸°ë„ í•©ë‹ˆë‹¤.
                ìƒ‰ì†ŒëŠ” ì£¼ë¡œ ê³ ì¹˜ì˜ ê²‰ë¶€ë¶„ì— ë¨¸ë¬¼ê¸° ë•Œë¬¸ì—, ê³ ì¹˜ë¥¼ ì‚¶ì•„ ê²‰ë¶€ë¶„ì„ ë²—ê¸°ëŠ” ê³¼ì •ì—ì„œ ìƒ‰ì†Œê°€ í•¨ê»˜ ë¹ ì ¸ë‚˜ê°€ í•˜ì–€ ì‹¤ë§Œ ë‚¨ê³ ,
                ì´ í•˜ì–€ ì‹¤ì€ ì—¼ìƒ‰í•˜ê¸° ì‰¬ì›Œ ì‚°ì—…ì—ì„œ ë„ë¦¬ ì‚¬ìš©ë©ë‹ˆë‹¤. ê°™ì€ ë½•ìì„ ë¨¹ì—¬ë„ ê°œì²´ë§ˆë‹¤ ê³ ì¹˜ ìƒ‰ì´ ë‹¤ë¥¸ ì´ìœ ëŠ” ë°”ë¡œ ì´ ìœ ì „ì ì°¨ì´ ë•Œë¬¸ì…ë‹ˆë‹¤.
              </div>
            </details>
          </div>
        </div>
      </div>
    </section>

    <!-- 20ê°œ ë¬¸í•­ -->
    <form id="form" class="card" enctype="multipart/form-data" style="margin-top:18px" novalidate>
      <div class="inner">
        <h2 class="form-section-title" style="margin:0 0 8px">ë¬¸í•­ (ì´ 20ë¬¸í•­)</h2>
        <div id="questions" style="display:grid;gap:12px;margin-top:8px"></div>

        <div class="actions">
          <button type="submit" class="btn success lg" id="btn-submit">ì œì¶œ</button>
          <button type="button" class="btn lg" id="btn-reset">ì´ˆê¸°í™”</button>
        </div>
        <div id="status" role="status" aria-live="polite"></div>

        <input class="hp" type="text" id="website" name="website" tabindex="-1" autocomplete="off" aria-hidden="true">
      </div>
    </form>
  </main>

  <script>
    /* ====== ì„¤ì •: ì›¹ì•± URL ====== */
    const ENDPOINT = 'https://script.google.com/macros/s/AKfycbxVl9s_cs47BxdB4QhE2HJgLZQKQ3lgAScF50FsYCHy-KEE21Uo92v7cEIXl3a-9fFugw/exec';

    /* ì´ë¯¸ì§€ ê¸°ë³¸ ê²½ë¡œ */
    const IMG_BASE = 'https://www.hanri.net/nunu/3rd_photo/';

    /* íƒ€ì… ë§¤í•‘: gold[5,17], trap[20,8], mimic[10,3,13], ë‚˜ë¨¸ì§€ normal */
    const GOLD = new Set([5,17]);
    const TRAP = new Set([20,8]);
    const MIMIC = new Set([10,3,13]);
    function getType(idx1){
      if(GOLD.has(idx1)) return 'gold';
      if(TRAP.has(idx1)) return 'trap';
      if(MIMIC.has(idx1)) return 'mimic';
      return 'normal';
    }
    function typeKorean(t){
      return t==='gold'?'í™©ê¸ˆê³ ì¹˜':t==='trap'?'í•¨ì •ê³ ì¹˜':t==='mimic'?'ë¯¸ë¯¹ê³ ì¹˜':'ì¼ë°˜ê³ ì¹˜';
    }
    function ruleText(t){
      switch(t){
        case 'gold': return 'ì •ë‹µ +3 / ì˜¤ë‹µ 0';
        case 'mimic': return 'ì •ë‹µ +2 / ì˜¤ë‹µ âˆ’2';
        case 'trap': return 'ì •ë‹µ âˆ’3 / ì˜¤ë‹µ 0';
        default: return 'ì •ë‹µ +1 / ì˜¤ë‹µ 0';
      }
    }
    function pad2(n){ return String(n).padStart(2,'0'); }

    /* ì´ë¦„ â†’ íŒŒì¼ëª…: "{ë²ˆí˜¸}_{ì´ë¦„}.jpg"
       - ì•ì˜ ìˆ«ì/êµ¬ë‘ì  ì œê±° -> ì—°ì† ê³µë°±ì€ "_"ë¡œ ì¹˜í™˜ -> ì•ë’¤ "_" ì •ë¦¬ -> URL ì¸ì½”ë”© */
    function toFileName(idx, displayName){
      const num = pad2(idx);
      const raw = (displayName||'')
        .replace(/^\s*\d+\s*[\.\-_\)]*\s*/,'');  // "01.", "01_", "01- " ë“± ì œê±°(ì—¬ëŸ¬ ê¸°í˜¸ í—ˆìš©)
      const withUnderscore = raw.trim()
        .replace(/\s+/g,'_')                     // ê³µë°±â†’_
        .replace(/^_+|_+$/g,'');                 // ì•ë’¤ _ ì œê±°
      const encoded = encodeURIComponent(withUnderscore); // í•œê¸€/íŠ¹ìˆ˜ë¬¸ì ì•ˆì „
      return `${num}_${encoded}.jpg`;
    }

    /* ë¬¸í•­ ì´ë¦„ */
    const ITEMS = [
      { name:'01. ëˆ„ë¦¬ë‹¤' },
      { name:'02. ëˆ„ë‚­ë¹„ê°•ë¬¸í•©ìˆ ' },
      { name:'03. ëˆ„ê°€ë³µìŒ' },
      { name:'04. ëˆ„ì›ŒìˆëŠ” ëˆ„ì—' },
      { name:'05. ëˆ„ì—ì—¥' },
      { name:'06. ëˆ„ì‚°ê¸°' },
      { name:'07. ëˆ„ê°€ ë‚´ë¨¸ë¦¬ì— ë˜¥ìŒŒì–´' },
      { name:'08. ëˆ„ê±°ë©ê±°ë©ìŠ¤' },
      { name:'09. ëˆ„ì—ì—£' },
      { name:'10. ëˆ„ëª…ì—ì„œ ë²—ì–´ë‚œ ëˆ„ì—' },
      { name:'11. ëˆ„êµ¬ë³´ë‹¤ ë¹ ë¥´ê²Œ' },
      { name:'12. ëˆ„ë¶•ì´' },
      { name:'13. ëˆ„í•­ì‚¬' },
      { name:'14. ëˆ„ìš°ë©´ì•ˆë¼' },
      { name:'15. ëˆ„ëˆ„ì™€ ìœŒëŸ¼í”„' },
      { name:'16. ëˆ„ëˆ„ ì—ìŠ¤í”¼ë¦¬íˆ¬ ì‚°íˆ¬' },
      { name:'17. ëˆ„ì°¨ ë§í•˜ì§€ë§Œ ëˆ„ì—ëŠ” ëˆ„ì—ì—¥' },
      { name:'18. ëˆ„ì§„ë‹¤ ì´ˆì ë Œì¦ˆ' },
      { name:'19. ëˆ„ì¢‹' },
      { name:'20_. ëˆ„êµ¬ì•¼' }
    ];

    const $ = (s)=>document.querySelector(s);
    const Q_TOTAL = ITEMS.length;

    /* íœ´ëŒ€í° 3-4-4 */
    function onlyDigits(s){ return (s||'').replace(/[^\d]/g,''); }
    function format344(d){
      d = onlyDigits(d).slice(0,11);
      if (d.length <= 3) return d;
      if (d.length <= 7) return d.slice(0,3) + '-' + d.slice(3);
      return d.slice(0,3) + '-' + d.slice(3,7) + '-' + d.slice(7);
    }
    const phoneInput = document.getElementById('phone');
    phoneInput.addEventListener('input', ()=>{
      const formatted = format344(phoneInput.value);
      phoneInput.value = formatted;
      phoneInput.setSelectionRange(formatted.length, formatted.length);
    });
    phoneInput.addEventListener('blur', ()=>{
      phoneInput.value = format344(phoneInput.value);
    });

    /* ë¬¸í•­ ë Œë”ë§ */
    const qWrap = $('#questions');
    ITEMS.forEach((it, idx)=>{
      const i = idx + 1;
      const t = getType(i);
      const fileName = toFileName(i, it.name);
      const imgUrl = IMG_BASE + fileName;

      const fs = document.createElement('fieldset');
      fs.dataset.index = i;
      fs.className = `type-${t}`;
      fs.innerHTML = `
        <legend>ë¬¸í•­ ${i}</legend>
        <div class="qgrid">
          <div class="photo">
            <img src="${imgUrl}" alt="${it.name} ì‚¬ì§„" draggable="false" oncontextmenu="return false" onerror="this.alt='ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'">
            <span class="flag ${t}" aria-label="${typeKorean(t)} ë°°ì§€">
              <i>${t==='gold'?'âœ¨':t==='mimic'?'ğŸ˜':t==='trap'?'âš ï¸':'ğŸ›'}</i>${typeKorean(t)}
            </span>
          </div>
          <div>
            <div class="name">${it.name}</div>
            <div class="pill ${t}" aria-label="ì ìˆ˜ ê·œì¹™">${ruleText(t)}</div>
            <div class="subnote">ì´ë¯¸ì§€ë¥¼ ì°¸ê³ í•˜ì—¬ ì„±ë³„ì„ ì„ íƒí•˜ì‹­ì‹œì˜¤.</div>
          </div>
          <div>
            <label>ì„±ë³„ ì„ íƒ <span class="req" style="color:#ef4444">*</span></label>
            <div class="radios" role="radiogroup" aria-label="${it.name} ì„±ë³„ ì„ íƒ">
              <label class="radio" data-type="F">
                <input type="radio" name="q${i}_gender" value="F"/>
                <span>ì•”ì»·</span>
              </label>
              <label class="radio" data-type="M">
                <input type="radio" name="q${i}_gender" value="M"/>
                <span>ìˆ˜ì»·</span>
              </label>
            </div>
            <div class="help-err" data-help style="display:none">ì´ ë¬¸í•­ì˜ ì„±ë³„ì„ ì„ íƒí•˜ì‹­ì‹œì˜¤.</div>
          </div>
        </div>
      `;
      qWrap.appendChild(fs);
    });

    /* ì´ë¯¸ì§€ ìš°í´ë¦­/ë“œë˜ê·¸ ë°©ì§€(ì¶”ê°€ ë³´í˜¸) */
    document.addEventListener('contextmenu', (e)=>{
      if(e.target && e.target.tagName==='IMG') e.preventDefault();
    });
    document.addEventListener('dragstart', (e)=>{
      if(e.target && e.target.tagName==='IMG') e.preventDefault();
    });

    // ì„ íƒ í† ê¸€
    function paintGroup(group){
      const labels = group.querySelectorAll('.radio');
      labels.forEach(lb => lb.classList.remove('selected-f','selected-m'));
      const checked = group.querySelector('input[type="radio"]:checked');
      if(!checked) return;
      const type = checked.value;
      const activeLabel = checked.closest('.radio');
      if(type === 'F'){ activeLabel.classList.add('selected-f'); }
      if(type === 'M'){ activeLabel.classList.add('selected-m'); }
      const fs = group.closest('fieldset');
      fs.classList.remove('invalid');
      const help = fs.querySelector('[data-help]');
      if(help){ help.style.display = 'none'; }
    }
    qWrap.addEventListener('change', (e)=>{
      const t = e.target;
      if(t.matches('input[type="radio"][name$="_gender"]')){
        const group = t.closest('.radios');
        paintGroup(group);
      }
    });

    // ì´ˆê¸°í™”
    $('#btn-reset').addEventListener('click', ()=>{
      document.getElementById('form').reset();
      document.querySelectorAll('.radio').forEach(lb=>lb.classList.remove('selected-f','selected-m'));
      document.querySelectorAll('fieldset').forEach(fs=>fs.classList.remove('invalid'));
      document.querySelectorAll('[data-help]').forEach(el=>el.style.display='none');
      ['nickname','realname','phone'].forEach(id=>$('#'+id).classList.remove('invalid'));
      $('#agreeWrap').classList.remove('checkbox-invalid');
      $('#status').textContent = '';
    });

    // ê²€ì¦
    function validateAllWithAlert(){
      const issues = [];
      const nickname = $('#nickname');
      const realname = $('#realname');
      const phone = $('#phone');
      const agree = $('#agree');

      [nickname,realname,phone].forEach(i=>i.classList.remove('invalid'));
      $('#agreeWrap').classList.remove('checkbox-invalid');

      const phoneDigits = (phone.value||'').replace(/[^\d]/g,'');
      if(!nickname.value.trim()){
        issues.push('ë‹‰ë„¤ì„'); nickname.classList.add('invalid');
      }
      if(!realname.value.trim()){
        issues.push('ì´ë¦„'); realname.classList.add('invalid');
      }
      if(!phoneDigits){
        issues.push('íœ´ëŒ€í° ë²ˆí˜¸'); phone.classList.add('invalid');
      }else if(phoneDigits.length !== 11){
        issues.push('íœ´ëŒ€í° ë²ˆí˜¸(11ìë¦¬)'); phone.classList.add('invalid');
      }else{
        phone.value = format344(phone.value);
      }
      if(!agree.checked){
        issues.push('ê°œì¸ì •ë³´ ë™ì˜'); $('#agreeWrap').classList.add('checkbox-invalid');
      }

      const missingQuestions = [];
      for(let i=1;i<=Q_TOTAL;i++){
        const fs = document.querySelector(`fieldset[data-index="${i}"]`);
        const checked = document.querySelector(`input[name="q${i}_gender"]:checked`);
        const help = fs.querySelector('[data-help]');
        if(!checked){
          missingQuestions.push(i);
          fs.classList.add('invalid');
          if(help) help.style.display = 'inline-block';
        }else{
          fs.classList.remove('invalid');
          if(help) help.style.display = 'none';
        }
      }

      if(issues.length || missingQuestions.length){
        let msg = '';
        if(issues.length) msg += `ë¯¸ì…ë ¥ í•­ëª©: ${issues.join(', ')}\n`;
        if(missingQuestions.length) msg += `ë¯¸ì„ íƒ ë¬¸í•­: ${missingQuestions.join(', ')}`;
        alert(msg.trim());
        const firstMiss = missingQuestions[0];
        if(firstMiss){
          document.querySelector(`fieldset[data-index="${firstMiss}"]`).scrollIntoView({behavior:'smooth', block:'center'});
        }else if(issues.length){
          (nickname.classList.contains('invalid') ? nickname :
           realname.classList.contains('invalid') ? realname :
           phone).focus();
        }
        return { ok:false };
      }
      return { ok:true };
    }

    function showStatusError(msg){ $('#status').innerHTML = `<span class="notice notice-err">${msg}</span>`; }
    function showStatusOk(msg){ $('#status').innerHTML = `<span class="notice notice-ok">${msg}</span>`; }

    // ì¤‘ë³µ í™•ì¸
    async function checkPhoneDuplicate(phoneDigits){
      const url = `${ENDPOINT}?action=checkPhone&phone=${encodeURIComponent(phoneDigits)}`;
      const res = await fetch(url, { method:'GET', cache:'no-store' });
      if(!res.ok) throw new Error('dup-check http error');
      const data = await res.json();
      if(data && data.ok === false) throw new Error('dup-check server error');
      return !!(data && data.exists);
    }

    // ì°¸ì—¬ í™•ì¸(í€µ ì²´í¬)
    const quickPhone = document.getElementById('quick-phone');
    if (quickPhone){
      quickPhone.addEventListener('input', ()=>{
        const v = format344(quickPhone.value);
        quickPhone.value = v;
        quickPhone.setSelectionRange(v.length, v.length);
      });
      quickPhone.addEventListener('blur', ()=>{
        quickPhone.value = format344(quickPhone.value);
      });
    }
    const quickBtn = document.getElementById('btn-quick-check');
    if (quickBtn){
      quickBtn.addEventListener('click', async ()=>{
        const st = document.getElementById('quick-status');
        const digits = onlyDigits((quickPhone?.value||'')).slice(0,11);
        st.innerHTML = '';
        if(digits.length !== 11){
          st.innerHTML = '<span class="notice notice-err">íœ´ëŒ€í° ë²ˆí˜¸ 11ìë¦¬ë¥¼ ì…ë ¥í•˜ì‹­ì‹œì˜¤.</span>';
          quickPhone?.focus();
          return;
        }
        const prev = quickBtn.textContent; quickBtn.disabled = true; quickBtn.textContent = 'í™•ì¸ ì¤‘â€¦';
        try{
          const exists = await checkPhoneDuplicate(digits);
          if(exists){
            st.innerHTML = '<span class="notice notice-ok">ì´ë¯¸ ì°¸ì—¬ ê¸°ë¡ì´ ìˆìŠµë‹ˆë‹¤. <a href="3rd_leaderboard.html">ë¦¬ë”ë³´ë“œ</a>ì—ì„œ í™•ì¸í•˜ì‹­ì‹œì˜¤.</span>';
          }else{
            st.innerHTML = '<span class="notice">ì•„ì§ ì œì¶œ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤. ì§€ê¸ˆ ì°¸ì—¬í•´ ì£¼ì‹­ì‹œì˜¤!</span>';
          }
        }catch(err){
          st.innerHTML = '<span class="notice notice-err">í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</span>';
        }finally{
          quickBtn.disabled = false; quickBtn.textContent = prev;
        }
      });
    }

    // ì œì¶œ ë°ì´í„°
    function buildFormData(){
      const fd = new FormData();
      fd.set('edition', $('#edition').value.trim());
      fd.set('nickname', $('#nickname').value.trim());
      fd.set('name', $('#realname').value.trim());
      fd.set('phone', $('#phone').value.trim());
      fd.set('phone_norm', onlyDigits($('#phone').value.trim()));
      fd.set('submittedAt', new Date().toISOString());
      for(let i=1;i<=Q_TOTAL;i++){
        const t = getType(i);
        const name = ITEMS[i-1].name;
        const fileName = toFileName(i, name);
        const imgUrl = IMG_BASE + fileName;
        const g = (document.querySelector(`input[name="q${i}_gender"]:checked`)||{}).value || '';
        fd.set(`q${i}_name`, name);
        fd.set(`q${i}_imageUrl`, imgUrl);
        fd.set(`q${i}_gender`, g);
        fd.set(`q${i}_type`, t);
      }
      return fd;
    }

    // ì œì¶œ
    document.getElementById('form').addEventListener('submit', async (e)=>{
      e.preventDefault();
      $('#status').textContent = '';

      const { ok } = validateAllWithAlert();
      if(!ok) return;

      const phoneDigits = (document.getElementById('phone').value || '').replace(/[^\d]/g,'');
      const btn = $('#btn-submit');
      btn.disabled = true; btn.textContent = 'ì¤‘ë³µ í™•ì¸ ì¤‘â€¦';

      try{
        const exists = await checkPhoneDuplicate(phoneDigits);
        if(exists){
          alert('ì´ë¯¸ ë™ì¼í•œ íœ´ëŒ€í° ë²ˆí˜¸ë¡œ ì œì¶œëœ ê¸°ë¡ì´ ìˆìŠµë‹ˆë‹¤. ì¤‘ë³µ ì œì¶œì€ ë¶ˆê°€í•©ë‹ˆë‹¤.');
          showStatusError('ì¤‘ë³µ ë²ˆí˜¸ë¡œ ì œì¶œ ì°¨ë‹¨');
          btn.disabled = false; btn.textContent = 'ì œì¶œ';
          return;
        }
      }catch(err){
        alert('ì¤‘ë³µ í™•ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•˜ì‹­ì‹œì˜¤.');
        showStatusError('ì¤‘ë³µ í™•ì¸ ì‹¤íŒ¨');
        btn.disabled = false; btn.textContent = 'ì œì¶œ';
        return;
      }

      btn.disabled = true; btn.textContent = 'ì „ì†¡ ì¤‘â€¦';
      try{
        const res = await fetch(ENDPOINT, { method:'POST', body: buildFormData() });
        const data = await res.json().catch(()=>({ok:res.ok}));
        if(res.ok && data && data.ok){
          showStatusOk('ì œì¶œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤!');
          alert('ì œì¶œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤!');
          document.getElementById('form').reset();
          document.querySelectorAll('.radio').forEach(lb=>lb.classList.remove('selected-f','selected-m'));
          document.querySelectorAll('fieldset').forEach(fs=>fs.classList.remove('invalid'));
          document.querySelectorAll('[data-help]').forEach(el=>el.style.display='none');
          ['nickname','realname','phone'].forEach(id=>$('#'+id).classList.remove('invalid'));
          $('#agreeWrap').classList.remove('checkbox-invalid');
        }else if (data && data.error === 'duplicate_phone'){
          alert('ì´ë¯¸ ë™ì¼í•œ íœ´ëŒ€í° ë²ˆí˜¸ë¡œ ì œì¶œëœ ê¸°ë¡ì´ ìˆìŠµë‹ˆë‹¤. ì¤‘ë³µ ì œì¶œì€ ë¶ˆê°€í•©ë‹ˆë‹¤.');
          showStatusError('ì¤‘ë³µ ë²ˆí˜¸ë¡œ ì œì¶œ ì°¨ë‹¨');
        }else{
          showStatusError('ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
          alert('ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
          console.error('Server response:', data);
        }
      }catch(err){
        console.error(err);
        showStatusError('ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        alert('ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      }finally{
        btn.disabled = false; btn.textContent = 'ì œì¶œ';
      }
    });
  </script>
</body>
</html>
