<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>ëˆ„ì— í‹°ì…”ì¸  ì£¼ë¬¸</title>
  <style>
    :root{
      --bg:#ffffff; --paper:#ffffff; --ink:#0f172a; --sub:#6b7280;
      --pri:#4b5563; --muted:#e5e7eb; --ring:rgba(107,114,128,.25);
      --shadow:0 10px 30px rgba(17,24,39,.08);
      --green:#059669; --blue:#1e3a8a; --danger:#ef4444;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Pretendard,Apple SD Gothic Neo,Malgun Gothic,Arial,sans-serif}
    .wrap{max-width:980px;margin:0 auto;padding:24px}

    /* NAV */
    header.nav{position:sticky;top:0;backdrop-filter:saturate(180%) blur(8px);background:rgba(247,246,243,.75);border-bottom:1px solid var(--muted);z-index:50}
    .nav-inner{display:flex;align-items:center;justify-content:flex-end;gap:12px;padding:12px 16px}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 14px;border-radius:999px;border:1px solid var(--muted);background:var(--paper);color:var(--ink);text-decoration:none;font-weight:600}
    .btn.primary{background:var(--pri);color:#fff;border:0}
    .btn.success{background:var(--green);color:#fff;border:0}
    .btn:hover{box-shadow:0 6px 18px rgba(15,23,42,.08)}
    .btn.lg{font-size:16px;padding:10px 18px;min-height:42px;min-width:140px}

    /* HERO */
    .hero{margin:20px auto 14px;border-radius:24px;background:
      radial-gradient(1200px 600px at 10% -10%, #f3f4f6, transparent 60%),
      radial-gradient(1200px 600px at 110% 10%, #eef2f7, transparent 60%),
      var(--paper);box-shadow:var(--shadow)}
    .hero-inner{display:grid;gap:8px;padding:24px}
    .hero h1{margin:0;font-size:clamp(22px,4vw,32px);letter-spacing:-.3px;line-height:1.15;text-align:center}
    .hero .sub{margin:6px 0 0;color:var(--sub);font-weight:600;text-align:center}

    /* CARD */
    .card{background:var(--paper);border:1px solid var(--muted);border-radius:16px;box-shadow:var(--shadow);overflow:hidden}
    .card .inner{padding:18px}

    /* PRODUCT â€” ì»¨í…Œì´ë„ˆì— ë¹„ìœ¨ì„ ì£¼ê³ , ì´ë¯¸ì§€ëŠ” 100% ì±„ì›€ */
    .prod-figure{
      position:relative; border:1px solid var(--muted); border-radius:12px; overflow:hidden;
      background:#f3f4f6; display:block; cursor:zoom-in; touch-action:pan-y;
      aspect-ratio: 5 / 4;                /* ë°ìŠ¤í¬í†± ê¸°ë³¸ ë¹„ìœ¨ */
      max-height: 72vh;                   /* í™”ë©´ì„ ë„˜ì¹˜ì§€ ì•Šë„ë¡ */
    }
    @media (max-width: 720px){
      .prod-figure{ aspect-ratio: 4 / 5;  max-height: 70vh; } /* ëª¨ë°”ì¼ ì„¸ë¡œí˜• ë¹„ìœ¨ */
    }
    .prod-figure img{
      width:100%; height:100%; display:block; object-fit:contain;
      transition: transform .22s ease, transform-origin .12s ease;
      will-change: transform;
    }
    .prod-figure[data-zoom="on"]{ cursor:zoom-out; }
    .prod-figure[data-zoom="on"] img{ transform:scale(1.9); }
    .zoom-hint{
      position:absolute; right:10px; bottom:10px;
      background:rgba(17,24,39,.65); color:#fff; font-size:12px;
      padding:4px 8px; border-radius:999px; pointer-events:none;
    }

    .prod-desc{margin-top:12px}
    .prod-desc h3{margin:0 0 8px}
    .prod-desc p{margin:0 0 10px;color:var(--sub)}
    .bullets{margin:8px 0 0;padding-left:18px}
    .bullets li{margin:4px 0}

    /* FORM */
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    @media (max-width:720px){.grid{grid-template-columns:1fr}}
    label{font-weight:700;display:block;margin-bottom:6px}
    .req{color:var(--danger)}
    .subnote{color:var(--sub);font-size:12px;margin-top:4px}
    input[type="text"], input[type="tel"], textarea, select{
      width:100%; padding:10px 12px; border-radius:10px; border:1px solid var(--muted); outline:none; background:#fff;
    }
    textarea{min-height:84px; resize:vertical}
    input:focus, textarea:focus, select:focus{box-shadow:0 0 0 3px var(--ring)}
    .invalid{border-color:#ef4444 !important; box-shadow:0 0 0 2px rgba(239,68,68,.2) !important}

    /* Radio pills */
    .radios{display:flex;gap:10px;flex-wrap:wrap}
    .radio{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border:1px solid var(--muted);border-radius:999px;cursor:pointer;background:#fff;user-select:none}
    .radio input{accent-color:#2563eb}
    .radio:hover{box-shadow:0 6px 18px rgba(15,23,42,.06)}
    .radio.selected{border-color:#93c5fd;background:#eff6ff;color:#1e3a8a}

    /* SIZE STEPPER */
    .sizes{display:grid;grid-template-columns:repeat(5,1fr);gap:10px}
    @media (max-width:900px){.sizes{grid-template-columns:repeat(3,1fr)}}
    .size-box{border:1px solid var(--muted);border-radius:12px;padding:10px;text-align:center;display:flex;flex-direction:column;gap:8px}
    .size-box h4{margin:0;font-size:14px}
    .stepper{display:flex;align-items:center;justify-content:center;gap:8px}
    .stepper button{width:34px;height:34px;border-radius:10px;border:1px solid var(--muted);background:#fff;cursor:pointer;font-size:18px;line-height:1}
    .stepper button:active{transform:translateY(1px)}
    .stepper input{width:64px;text-align:center;padding:8px 6px;border-radius:10px;border:1px solid var(--muted);background:#fff}
    .stepper input[readonly]{background:#fff}
    .total{margin-top:10px;font-weight:800;color:var(--blue)}

    /* SUMMARY */
    .paybox{margin-top:12px;border:1px dashed #cbd5e1;border-radius:12px;padding:12px}
    .paybox .row{display:flex;justify-content:space-between;gap:10px;margin:4px 0}
    .paybox .row.total{font-weight:900;border-top:1px solid #e5e7eb;padding-top:8px}
    .paybox .acc{margin-top:6px;color:#111827}
    .paybox .note{color:#6b7280;font-size:13px;margin-top:6px}

    /* TABLE (ì‚¬ì´ì¦ˆí‘œ) */
    .table-wrap{border:1px solid var(--muted);border-radius:12px;background:#fff;overflow:auto}
    table{width:100%;border-collapse:separate;border-spacing:0}
    thead th{position:sticky;top:0;background:#f8fafc;border-bottom:1px solid var(--muted);text-align:left;padding:10px 12px;font-size:14px;color:#334155;white-space:nowrap}
    tbody td{padding:10px 12px;border-bottom:1px solid #f1f5f9;vertical-align:middle}
    tbody tr:hover{background:#fafafa}

    /* í•˜ë‹¨ ë²„íŠ¼ ì¤‘ì•™ì •ë ¬ + ìœ„ ê°„ê²© ì†Œí­ */
    .actions{display:flex;gap:12px;justify-content:center;margin-top:12px}
  </style>
  <!-- ì¹´ì¹´ì˜¤ ìš°í¸ë²ˆí˜¸ -->
  <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
</head>
<body>
  <header class="nav">
    <div class="nav-inner wrap">
      <a class="btn" href="index.html">Home</a>
    </div>
  </header>

  <main class="wrap">
    <!-- HERO -->
    <section class="hero">
      <div class="hero-inner">
        <h1>ëˆ„ì— í‹°ì…”ì¸  ì£¼ë¬¸</h1>
        <div class="sub">ë’·ë©´ ì˜µì…˜ì— ë”°ë¼ ë‹¨ê°€ê°€ ë‹¬ë¼ì§‘ë‹ˆë‹¤. í•œ ì£¼ë¬¸ì„œì—ëŠ” <b>í•˜ë‚˜ì˜ ë’·ë©´ ì˜µì…˜ë§Œ</b> ì„ íƒí•´ ì£¼ì„¸ìš”.</div>
      </div>
    </section>

    <!-- ì œí’ˆ ì†Œê°œ -->
    <section class="card" aria-labelledby="hdr-prod">
      <div class="inner">
        <figure class="prod-figure" id="prodFigure" aria-label="ì œí’ˆ ì´ë¯¸ì§€ í™•ëŒ€ ê°€ëŠ¥">
          <img id="prodImg" src="https://www.hanri.net/nunu/nunu_tshirt_image.png" alt="ëˆ„ì— í‹°ì…”ì¸  ì œí’ˆ ì´ë¯¸ì§€" onerror="this.style.opacity=.25; this.alt='ì´ë¯¸ì§€ ì¤€ë¹„ì¤‘'">
          <div class="zoom-hint">ğŸ” ë§ˆìš°ìŠ¤ë¡œ í™•ëŒ€ / ëª¨ë°”ì¼ íƒ­</div>
        </figure>
        <div class="prod-desc">
          <h3 id="hdr-prod">ëˆ„ëˆ„ ì¼€ë¦­í„° í‹°ì…”ì¸ </h3>
          <p>ê·€ì—¬ìš´ ëˆ„ì—ì™€ í•˜ë£¨ë¥¼ í•¨ê»˜ ì‹œì‘í•´ë³´ì„¸ìš”! ë¶€ë“œëŸ¬ìš´ ì½”íŠ¼ ì›ë‹¨ì— ê·€ì—¬ìš´ ëˆ„ì—ì„ ë”í•œ ë°ì¼ë¦¬ í‹°ì…”ì¸ ì…ë‹ˆë‹¤. í°ìƒ‰/ê²€ì€ìƒ‰ 2ê°€ì§€ ìƒ‰ìƒê³¼ ë’·ë©´ ì˜µì…˜ ì—†ìŒÂ·í…ìŠ¤íŠ¸í˜• ì¤‘ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤. ëˆ„ì—ì—¥~</p>
          <ul class="bullets">
            <li><b>ê°€ê²©</b> â€” ë’·ë©´ ì˜µì…˜ <u>ì—†ìŒ 16,000ì›</u> Â· <u>í…ìŠ¤íŠ¸í˜• 23,000ì›</u> (ì¥ë‹¹)</li>
            <li><b>ë°°ì†¡ë¹„</b> â€” 4,000ì›(ì£¼ë¬¸ë‹¹)</li>
            <li><b>ì…ê¸ˆ ê³„ì¢Œ</b> â€” ë†í˜‘ <u>302-1235-6391-61</u> (ì˜ˆê¸ˆì£¼: í•œë¦¬)</li>
            <li>ì‚¬ì´ì¦ˆ: S Â· M Â· L Â· XL Â· 2XL</li>
            <li>ì†Œì¬: ë©´100% (ì• ì‰¬ 95/5, ëª¨ì¿ ê·¸ë ˆì´ 80/20)</li>
            <li>í•: ì •ì‚¬ì´ì¦ˆ(ë‚¨ë…€ê³µìš©) Â· ì‹ ì¶•ì„± ì¢‹ìŒ Â· ë„í†°í•œ 17ìˆ˜</li>
          </ul>
          <p class="sub" style="margin-top:8px"><b>ì•ˆë‚´</b> â€” ë’·ë©´ ì˜µì…˜ì´ ë‹¤ë¥¸ ê²½ìš° <u>ê° ì˜µì…˜ë³„ë¡œ ì£¼ë¬¸ì„œë¥¼ ë”°ë¡œ ì œì¶œ</u>í•´ ì£¼ì„¸ìš”. (ì˜ˆ: ì—†ìŒ 2ì¥ / í…ìŠ¤íŠ¸í˜• 1ì¥ â‡’ 2ê±´ìœ¼ë¡œ ì ‘ìˆ˜)</p>
        </div>
      </div>
    </section>

    <!-- ì£¼ë¬¸ì ì •ë³´ -->
    <section class="card" style="margin-top:16px" aria-labelledby="hdr-orderer">
      <div class="inner">
        <h2 id="hdr-orderer" style="margin:0 0 12px">ì£¼ë¬¸ì ì •ë³´</h2>
        <div class="grid">
          <div>
            <label for="custName">ì£¼ë¬¸ì ëª… <span class="req">*</span></label>
            <input id="custName" type="text" placeholder="ì˜ˆ: í™ê¸¸ë™"/>
          </div>
          <div>
            <label for="phone">ì „í™”ë²ˆí˜¸ <span class="req">*</span></label>
            <input id="phone" type="tel" inputmode="tel" maxlength="13" placeholder="ì˜ˆ: 010-1234-5678"/>
            <div class="subnote">ì…ë ¥ ì‹œ ìë™ìœ¼ë¡œ 000-0000-0000 í˜•ì‹ìœ¼ë¡œ ë³€í™˜ë©ë‹ˆë‹¤.</div>
          </div>
          <!-- ì£¼ì†Œ -->
          <div style="grid-column:1/-1">
            <label>ì§‘ ì£¼ì†Œ <span class="req">*</span></label>
            <div class="addr-row" style="display:grid;grid-template-columns:140px 1fr auto;gap:10px;margin-bottom:8px">
              <input id="postcode" type="text" placeholder="ìš°í¸ë²ˆí˜¸" readonly/>
              <input id="addr1" type="text" placeholder="ë„ë¡œëª… ì£¼ì†Œ" readonly/>
              <button type="button" class="btn" id="btnFindAddr">ì£¼ì†Œ ì°¾ê¸°</button>
            </div>
            <input id="addr2" type="text" placeholder="ìƒì„¸ ì£¼ì†Œ (ë™/í˜¸ìˆ˜ ë“±)"/>
            <div class="subnote">â€˜ì£¼ì†Œ ì°¾ê¸°â€™ë¡œ ìš°í¸ë²ˆí˜¸/ë„ë¡œëª… ì£¼ì†Œë¥¼ ì±„ìš´ ë’¤, ìƒì„¸ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- ì˜µì…˜ -->
    <section class="card" style="margin-top:16px" aria-labelledby="hdr-opt">
      <div class="inner">
        <h2 id="hdr-opt" style="margin:0 0 12px">ì˜µì…˜ ì„ íƒ</h2>
        <div class="grid">
          <!-- ìƒ‰ìƒ -->
          <div>
            <label>í‹°ì…”ì¸  ìƒ‰ìƒ <span class="req">*</span></label>
            <div class="radios" id="colorGroup" role="radiogroup" aria-label="í‹°ì…”ì¸  ìƒ‰ìƒ">
              <label class="radio"><input type="radio" name="color" value="í°ìƒ‰" hidden/><span>í°ìƒ‰</span></label>
              <label class="radio"><input type="radio" name="color" value="ê²€ì€ìƒ‰" hidden/><span>ê²€ì€ìƒ‰</span></label>
            </div>
          </div>
          <!-- ë’·ë©´ ì˜µì…˜ -->
          <div>
            <label>ë’·ë©´ ì˜µì…˜ <span class="req">*</span></label>
            <div class="radios" id="designGroup" role="radiogroup" aria-label="ë’·ë©´ ì˜µì…˜">
              <label class="radio"><input type="radio" name="design" value="ì—†ìŒ" hidden/><span>ì—†ìŒ (â‚©16,000)</span></label>
              <label class="radio"><input type="radio" name="design" value="í…ìŠ¤íŠ¸í˜•" hidden/><span>í…ìŠ¤íŠ¸í˜• (â‚©23,000)</span></label>
            </div>
            <div class="subnote">â€» í•œ ì£¼ë¬¸ì„œì—ëŠ” í•˜ë‚˜ì˜ ë’·ë©´ ì˜µì…˜ë§Œ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì˜µì…˜ì´ ë‹¤ë¥´ë©´ ì£¼ë¬¸ì„ ë‚˜ëˆ  ì£¼ì„¸ìš”.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- ì‚¬ì´ì¦ˆ ì •ë³´ -->
    <section class="card" style="margin-top:16px" aria-labelledby="hdr-size">
      <div class="inner">
        <h2 id="hdr-size" style="margin:0 0 12px">ì‚¬ì´ì¦ˆ ì •ë³´</h2>
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>Size (cm)</th>
                <th>S</th><th>M</th><th>L</th><th>XL</th><th>2XL</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>ì´ê¸°ì¥</td><td>66</td><td>70</td><td>74</td><td>77</td><td>81</td></tr>
              <tr><td>ì–´ê¹¨ë„ˆë¹„</td><td>45.5</td><td>48</td><td>50</td><td>53</td><td>55</td></tr>
              <tr><td>ê°€ìŠ´ë„ˆë¹„</td><td>47</td><td>51</td><td>54</td><td>56</td><td>59</td></tr>
              <tr><td>ì†Œë§¤ê¸¸ì´</td><td>19</td><td>19.5</td><td>21</td><td>23</td><td>25</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- ì‚¬ì´ì¦ˆ ìˆ˜ëŸ‰ & ê²°ì œ ìš”ì•½ -->
    <form id="orderForm" class="card" style="margin-top:16px" novalidate>
      <div class="inner">
        <h2 style="margin:0 0 12px">ì‚¬ì´ì¦ˆë³„ ìˆ˜ëŸ‰</h2>
        <div class="sizes" id="sizesWrap">
          <div class="size-box" data-size="S"><h4>S</h4>
            <div class="stepper">
              <button type="button" class="qty-btn" data-delta="-1">âˆ’</button>
              <input type="number" value="0" min="0" max="99" readonly>
              <button type="button" class="qty-btn" data-delta="1">+</button>
            </div>
          </div>
          <div class="size-box" data-size="M"><h4>M</h4>
            <div class="stepper">
              <button type="button" class="qty-btn" data-delta="-1">âˆ’</button>
              <input type="number" value="0" min="0" max="99" readonly>
              <button type="button" class="qty-btn" data-delta="1">+</button>
            </div>
          </div>
          <div class="size-box" data-size="L"><h4>L</h4>
            <div class="stepper">
              <button type="button" class="qty-btn" data-delta="-1">âˆ’</button>
              <input type="number" value="0" min="0" max="99" readonly>
              <button type="button" class="qty-btn" data-delta="1">+</button>
            </div>
          </div>
          <div class="size-box" data-size="XL"><h4>XL</h4>
            <div class="stepper">
              <button type="button" class="qty-btn" data-delta="-1">âˆ’</button>
              <input type="number" value="0" min="0" max="99" readonly>
              <button type="button" class="qty-btn" data-delta="1">+</button>
            </div>
          </div>
          <div class="size-box" data-size="2XL"><h4>2XL</h4>
            <div class="stepper">
              <button type="button" class="qty-btn" data-delta="-1">âˆ’</button>
              <input type="number" value="0" min="0" max="99" readonly>
              <button type="button" class="qty-btn" data-delta="1">+</button>
            </div>
          </div>
        </div>

        <div class="paybox" id="paybox">
          <div class="row"><span>ì„ íƒ ìˆ˜ëŸ‰</span><strong id="qTotal">0 ì¥</strong></div>
          <div class="row"><span>ë‹¨ê°€(ë’·ë©´ ì˜µì…˜)</span><strong id="unitPrice">â€”</strong></div>
          <div class="row"><span>ì†Œê³„</span><strong id="subtotal">â€”</strong></div>
          <div class="row"><span>ë°°ì†¡ë¹„</span><strong id="shipping">â‚©0</strong></div>
          <div class="row total"><span>ì´ ê²°ì œê¸ˆì•¡</span><strong id="grandTotal">â‚©0</strong></div>
          <div class="acc">ì…ê¸ˆ ê³„ì¢Œ: <b>ë†í˜‘ 302-1235-6391-61 (ì˜ˆê¸ˆì£¼: í•œë¦¬)</b></div>
          <div class="note">ì£¼ë¬¸ì„œ ì œì¶œ í›„ ìœ„ ê³„ì¢Œë¡œ ì…ê¸ˆí•´ ì£¼ì„¸ìš”. (ì…ê¸ˆìëª…=ì£¼ë¬¸ìëª…)</div>
        </div>

        <div class="actions">
          <button type="submit" class="btn success lg" id="btnSubmit">ì£¼ë¬¸ ì œì¶œ</button>
          <button type="button" class="btn lg" id="btnReset">ì´ˆê¸°í™”</button>
        </div>
        <div id="status" role="status" aria-live="polite"></div>
      </div>
    </form>
  </main>

  <!-- ì¹´ì¹´ì˜¤ ìš°í¸ë²ˆí˜¸ SDK -->
  <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
  <script>
    /* â˜… Apps Script ì›¹ì•± URLë¡œ êµì²´ */
    const ENDPOINT = 'https://script.google.com/macros/s/PASTE_YOUR_DEPLOYMENT_ID/exec';
    const $ = (s)=>document.querySelector(s);

    /* ê°€ê²© ìƒìˆ˜ */
    const PRICE_NO_BACK = 16000;
    const PRICE_TEXTBACK = 23000;
    const SHIPPING = 4000;
    const nf = new Intl.NumberFormat('ko-KR');

    /* ì „í™”ë²ˆí˜¸ ìë™ í•˜ì´í”ˆ */
    const onlyDigits = s => (s||'').replace(/[^\d]/g,'');
    const format344 = d => {
      d = onlyDigits(d).slice(0,11);
      if (d.length <= 3) return d;
      if (d.length <= 7) return d.slice(0,3) + '-' + d.slice(3);
      return d.slice(0,3) + '-' + d.slice(3,7) + '-' + d.slice(7);
    };
    const phoneInput = $('#phone');
    phoneInput.addEventListener('input', ()=>{
      const v = format344(phoneInput.value);
      phoneInput.value = v;
      phoneInput.setSelectionRange(v.length, v.length);
    });
    phoneInput.addEventListener('blur', ()=> phoneInput.value = format344(phoneInput.value));

    /* ì£¼ì†Œ ì°¾ê¸° */
    function openPostcode(){
      new daum.Postcode({
        oncomplete: function(data){
          $('#postcode').value = data.zonecode || '';
          $('#addr1').value = data.roadAddress || data.address || '';
          $('#addr2').focus();
        }
      }).open();
    }
    document.getElementById('btnFindAddr').addEventListener('click', openPostcode);

    /* ë¼ë””ì˜¤ pill */
    function wirePillGroup(groupEl){
      groupEl.addEventListener('click', (e)=>{
        const label = e.target.closest('.radio'); if(!label) return;
        const input = label.querySelector('input[type="radio"]'); if(!input) return;
        groupEl.querySelectorAll('.radio').forEach(lb=>{
          lb.classList.remove('selected');
          const i = lb.querySelector('input[type="radio"]'); if(i) i.checked = false;
        });
        input.checked = true; label.classList.add('selected');
        groupEl.classList.remove('invalid');
        if(groupEl.id === 'designGroup') updateTotals();
      });
    }
    wirePillGroup(document.getElementById('colorGroup'));
    wirePillGroup(document.getElementById('designGroup'));

    /* ìˆ˜ëŸ‰ ìŠ¤í…í¼ + í•©ê³„ */
    const sizesWrap = document.getElementById('sizesWrap');
    sizesWrap.addEventListener('click', (e)=>{
      const btn = e.target.closest('.qty-btn'); if(!btn) return;
      const box = btn.closest('.size-box');
      const input = box.querySelector('input[type="number"]');
      const delta = parseInt(btn.dataset.delta,10);
      const min = parseInt(input.min||'0',10);
      const max = parseInt(input.max||'99',10);
      const next = Math.max(min, Math.min(max, (parseInt(input.value,10)||0)+delta));
      input.value = next;
      updateTotals();
    });

    function getQtyTotal(){
      let t = 0;
      sizesWrap.querySelectorAll('input[type="number"]').forEach(i=> t += (parseInt(i.value,10)||0) );
      return t;
    }
    function getUnitPrice(){
      const d = (document.querySelector('input[name="design"]:checked')||{}).value || '';
      if(d === 'í…ìŠ¤íŠ¸í˜•') return PRICE_TEXTBACK;
      if(d === 'ì—†ìŒ') return PRICE_NO_BACK;
      return null;
    }
    function updateTotals(){
      const qty = getQtyTotal();
      const unit = getUnitPrice();
      const shipping = qty>0 ? SHIPPING : 0;
      const subtotal = unit ? unit * qty : 0;
      const grand = subtotal + shipping;

      $('#qTotal').textContent   = `${qty} ì¥`;
      $('#unitPrice').textContent= unit ? `â‚©${nf.format(unit)}` : 'â€”';
      $('#subtotal').textContent = unit ? `â‚©${nf.format(subtotal)}` : 'â€”';
      $('#shipping').textContent = `â‚©${nf.format(shipping)}`;
      $('#grandTotal').textContent= `â‚©${nf.format(grand)}`;
    }
    updateTotals();

    /* ì´ë¯¸ì§€ ì¤Œ: ë°ìŠ¤í¬í†± hover, ëª¨ë°”ì¼ íƒ­ í† ê¸€ */
    (function setupZoom(){
      const fig = document.getElementById('prodFigure');
      const img = document.getElementById('prodImg');
      if(!fig || !img) return;
      let active = false;

      const setOrigin = (clientX, clientY)=>{
        const rect = fig.getBoundingClientRect();
        const x = Math.max(0, Math.min(100, ((clientX - rect.left) / rect.width) * 100));
        const y = Math.max(0, Math.min(100, ((clientY - rect.top) / rect.height) * 100));
        img.style.transformOrigin = `${x}% ${y}%`;
      };

      fig.addEventListener('pointerenter', (e)=>{ active = true; fig.dataset.zoom='on'; setOrigin(e.clientX, e.clientY); });
      fig.addEventListener('pointerleave', ()=>{ active = false; fig.dataset.zoom='off'; img.style.transformOrigin='center center'; });
      fig.addEventListener('pointermove', (e)=>{ if(active) setOrigin(e.clientX, e.clientY); });
      fig.addEventListener('pointerdown', (e)=>{
        if(e.pointerType !== 'mouse'){
          active = !active;
          fig.dataset.zoom = active ? 'on' : 'off';
          if(active) setOrigin(e.clientX, e.clientY);
          else img.style.transformOrigin='center center';
        }
      });
    })();

    /* ìƒíƒœ í‘œì‹œ */
    function showStatusOk(msg){ document.getElementById('status').innerHTML = `<span style="font-weight:700;color:#065f46">${msg}</span>`; }
    function showStatusErr(msg){ document.getElementById('status').innerHTML = `<span style="font-weight:700;color:#b91c1c">${msg}</span>`; }

    /* ê²€ì¦ */
    function validate(){
      const issues = [];
      ['custName','phone','postcode','addr1','addr2'].forEach(id=>document.getElementById(id).classList.remove('invalid'));
      document.getElementById('colorGroup').classList.remove('invalid');
      document.getElementById('designGroup').classList.remove('invalid');

      const name = $('#custName').value.trim();
      const phoneDigits = ( $('#phone').value || '' ).replace(/[^\d]/g,'');
      const postcode = $('#postcode').value.trim();
      const addr1 = $('#addr1').value.trim();
      const addr2 = $('#addr2').value.trim();
      const color = (document.querySelector('input[name="color"]:checked')||{}).value || '';
      const design= (document.querySelector('input[name="design"]:checked')||{}).value || '';
      const qtyTotal = getQtyTotal();

      if(!name){ issues.push('ì£¼ë¬¸ì ëª…'); $('#custName').classList.add('invalid'); }
      if(phoneDigits.length !== 11){ issues.push('ì „í™”ë²ˆí˜¸(11ìë¦¬)'); $('#phone').classList.add('invalid'); }
      if(!postcode){ issues.push('ìš°í¸ë²ˆí˜¸'); $('#postcode').classList.add('invalid'); }
      if(!addr1){ issues.push('ë„ë¡œëª… ì£¼ì†Œ'); $('#addr1').classList.add('invalid'); }
      if(!addr2){ issues.push('ìƒì„¸ ì£¼ì†Œ'); $('#addr2').classList.add('invalid'); }
      if(!color){ issues.push('í‹°ì…”ì¸  ìƒ‰ìƒ'); $('#colorGroup').classList.add('invalid'); }
      if(!design){ issues.push('ë’·ë©´ ì˜µì…˜'); $('#designGroup').classList.add('invalid'); }
      if(qtyTotal <= 0){ issues.push('ì‚¬ì´ì¦ˆë³„ ìˆ˜ëŸ‰(ìµœì†Œ 1ì¥)'); }

      if(issues.length){
        alert('ë‹¤ìŒ í•­ëª©ì„ í™•ì¸í•´ ì£¼ì„¸ìš”:\n- ' + issues.join('\n- '));
        return false;
      }
      return true;
    }

    /* ì œì¶œ ë°ì´í„° */
    function buildFormData(){
      const fd = new FormData();
      fd.set('form', 'tshirt_order');
      fd.set('customerName', $('#custName').value.trim());
      fd.set('phone', $('#phone').value.trim());
      fd.set('phone_norm', ($('#phone').value||'').replace(/[^\d]/g,''));
      fd.set('postcode', $('#postcode').value.trim());
      fd.set('address1', $('#addr1').value.trim());
      fd.set('address2', $('#addr2').value.trim());
      fd.set('address_full', `${$('#addr1').value.trim()} ${$('#addr2').value.trim()}`.trim());
      fd.set('color', (document.querySelector('input[name="color"]:checked')||{}).value || '');
      fd.set('design', (document.querySelector('input[name="design"]:checked')||{}).value || '');

      const sizes = {};
      document.querySelectorAll('.size-box').forEach(box=>{
        const sz = box.dataset.size;
        const val = box.querySelector('input[type="number"]').value || '0';
        sizes[sz] = val;
        fd.set('qty_'+sz, val);
      });
      const qtyTotal = getQtyTotal();
      const unit = getUnitPrice() || 0;
      const subtotal = unit * qtyTotal;
      const shipping = qtyTotal>0 ? 4000 : 0;
      const grand = subtotal + shipping;

      fd.set('sizes_json', JSON.stringify(sizes));
      fd.set('qty_total', String(qtyTotal));
      fd.set('unit_price', String(unit));
      fd.set('subtotal', String(subtotal));
      fd.set('shipping', String(shipping));
      fd.set('grand_total', String(grand));
      fd.set('submittedAt', new Date().toISOString());
      return fd;
    }

    /* ì´ˆê¸°í™” */
    document.getElementById('btnReset').addEventListener('click', ()=>{
      document.getElementById('orderForm').reset();
      document.querySelectorAll('.radio').forEach(lb=>lb.classList.remove('selected'));
      document.querySelectorAll('.invalid').forEach(el=>el.classList.remove('invalid'));
      document.querySelectorAll('.size-box input[type="number"]').forEach(i=> i.value = '0');
      updateTotals();
      showStatusOk('ì´ˆê¸°í™” ì™„ë£Œ');
    });

    /* ì œì¶œ */
    document.getElementById('orderForm').addEventListener('submit', async (e)=>{
      e.preventDefault();
      if(!validate()) return;

      const btn = document.getElementById('btnSubmit');
      btn.disabled = true; btn.textContent = 'ì „ì†¡ ì¤‘â€¦';

      try{
        const res = await fetch(ENDPOINT, { method:'POST', body: buildFormData() });
        const data = await res.json().catch(()=>({ok:res.ok}));
        if(res.ok && data && data.ok){
          alert('ì£¼ë¬¸ì´ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤!');
          document.getElementById('orderForm').reset();
          document.querySelectorAll('.radio').forEach(lb=>lb.classList.remove('selected'));
          document.querySelectorAll('.size-box input[type="number"]').forEach(i=> i.value = '0');
          updateTotals();
        }else{
          console.error('Server response:', data);
          alert('ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
      }catch(err){
        console.error(err);
        alert('ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      }finally{
        btn.disabled = false; btn.textContent = 'ì£¼ë¬¸ ì œì¶œ';
      }
    });

    /* í•©ê³„ ìµœì´ˆ ê³„ì‚° */
    updateTotals();

    /* ì¤Œ ì›ì  ë³´ì • (ì´ë¯¸ ìœ„ì—ì„œ ì„¤ì •) */
    (function setupZoom(){
      const fig = document.getElementById('prodFigure');
      const img = document.getElementById('prodImg');
      if(!fig || !img) return;
      let active = false;

      const setOrigin = (clientX, clientY)=>{
        const rect = fig.getBoundingClientRect();
        const x = Math.max(0, Math.min(100, ((clientX - rect.left) / rect.width) * 100));
        const y = Math.max(0, Math.min(100, ((clientY - rect.top) / rect.height) * 100));
        img.style.transformOrigin = `${x}% ${y}%`;
      };

      fig.addEventListener('pointerenter', (e)=>{ active = true; fig.dataset.zoom='on'; setOrigin(e.clientX, e.clientY); });
      fig.addEventListener('pointerleave', ()=>{ active = false; fig.dataset.zoom='off'; img.style.transformOrigin='center center'; });
      fig.addEventListener('pointermove', (e)=>{ if(active) setOrigin(e.clientX, e.clientY); });
      fig.addEventListener('pointerdown', (e)=>{
        if(e.pointerType !== 'mouse'){
          active = !active;
          fig.dataset.zoom = active ? 'on' : 'off';
          if(active) setOrigin(e.clientX, e.clientY);
          else img.style.transformOrigin='center center';
        }
      });
    })();
  </script>
</body>
</html>
